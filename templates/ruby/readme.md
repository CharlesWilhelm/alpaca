# {{.Pkg.Git.Name}}-ruby

{{if .Pkg.Official}}Official {{end}}{{.Pkg.Name}} API library client for ruby

__This library is generated by [alpaca](https://github.com/pksunkara/alpaca)__

## Installation

Make sure you have [rubygems](https://rubygems.org) installed

```bash
$ gem install {{.Pkg.Package}}
```

#### Versions

Works with [ 1.8.6 / 1.8.7 / 1.9.1 / 1.9.2 / 1.9.3 / 2.0.0 / 2.1.0 / 2.1.1 ]

## Usage

```ruby
require "{{.Pkg.Package}}"

# Then we instantiate a client (as shown below)
```

### Build a client
{{if .Api.Authorization.NeedAuth}}
__Using this api without authentication gives an error__
{{else}}
##### Without any authentication

```ruby
client = {{call .Fnc.camelize .Pkg.Name}}::Client.new{{if .Api.BaseAsArg}}('{{.Api.Base}}'){{end}}

# If you need to send options
client = {{call .Fnc.camelize .Pkg.Name}}::Client.new({{if .Api.BaseAsArg}}'{{.Api.Base}}', {{end}}{}, client_options)
```
{{end}}{{if .Api.Authorization.Basic}}
##### Basic authentication

```ruby
auth = { :username => 'pksunkara', :password => 'password' }

client = {{call .Fnc.camelize .Pkg.Name}}::Client.new({{if .Api.BaseAsArg}}'{{.Api.Base}}', {{end}}auth, client_options)
```
{{end}}{{if .Api.Authorization.Header}}
##### Authorization header token

```ruby
client = {{call .Fnc.camelize .Pkg.Name}}::Client.new({{if .Api.BaseAsArg}}'{{.Api.Base}}', {{end}}{{if .Api.Authorization.Oauth}}{:http_header => '1a2b3'}{{else}}'1a2b3'{{end}}, client_options)
```
{{end}}{{if .Api.Authorization.Oauth}}
##### Oauth access token

```ruby
client = {{call .Fnc.camelize .Pkg.Name}}::Client.new({{if .Api.BaseAsArg}}'{{.Api.Base}}', {{end}}'1a2b3', client_options)
```

##### Oauth client secret

```ruby
auth = { :client_id => '09a8b7', :client_secret => '1a2b3' }

client = {{call .Fnc.camelize .Pkg.Name}}::Client.new({{if .Api.BaseAsArg}}'{{.Api.Base}}', {{end}}auth, client_options)
```
{{end}}
### Client Options

The following options are available while instantiating a client:

 * __base__: Base url for the api
 * __api_version__: Default version of the api (to be used in url)
 * __user_agent__: Default user-agent for all requests
 * __headers__: Default headers for all requests
 * __request_type__: Default format of the request body{{if .Api.Response.Suffix}}
 * __response_type__: Default format of the response (to be used in url suffix){{end}}

### Response information

__All the callbacks provided to an api call will receive the response as shown below__

```ruby
response = client.klass('args').method('args', method_options)

response.code
# >>> 200

response.headers
# >>> {'x-server' => 'apache'}
```
{{if .Api.Response.Formats.Html}}
##### HTML/TEXT response

When the response sent by server is either __html__ or __text__, it is not changed in any way

```ruby
response.body
# >>> 'The username is pksunkara!'
```
{{end}}{{if .Api.Response.Formats.Json}}
##### JSON response

When the response sent by server is __json__, it is decoded into a hash

```ruby
response.body
# >>> {'user' => 'pksunkara'}
```
{{end}}
### Method Options

The following options are available while calling a method of an api:

 * __api_version__: Version of the api (to be used in url)
 * __headers__: Headers for the request
 * __query__: Query parameters for the url
 * __body__: Body of the request
 * __request_type__: Format of the request body{{if .Api.Response.Suffix}}
 * __response_type__: Format of the response (to be used in url suffix){{end}}

### Request body information

Set __request_type__ in options to modify the body accordingly

##### RAW request

When the value is set to __raw__, don't modify the body at all.

```ruby
body = 'username=pksunkara'
# >>> 'username=pksunkara'
```
{{if .Api.Request.Formats.Form}}
##### FORM request

When the value is set to __form__, urlencode the body.

```ruby
body = {'user' => 'pksunkara'}
# >>> 'user=pksunkara'
```
{{end}}{{if .Api.Request.Formats.Json}}
##### JSON request

When the value is set to __json__, JSON encode the body.

```ruby
body = {'user' => 'pksunkara'}
# >>> '{"user": "pksunkara"}'
```
{{end}}{{with $data := .}}{{range .Api.Classes}}
### {{(index $data.Doc .Name).Title}} api

{{(index $data.Doc .Name).Desc}}{{with .Args}}

The following arguments are required:
{{end}}{{with $class := .}}{{range .Args}}
 * __{{.}}__: {{(index ((index $data.Doc $class.Name).Args) .).Desc}}{{end}}

```ruby
{{call $data.Fnc.underscore $class.Name}} = client.{{call $data.Fnc.underscore $class.Name}}({{call $data.Fnc.prnt.ruby .Args ((index $data.Doc $class.Name).Args) ", " false}})
```
{{range $class.Functions}}
##### {{(index ((index $data.Doc $class.Name).Functions) .Name).Title}} ({{call $data.Fnc.upper (or .Method "get")}} {{.Path}})

{{(index ((index $data.Doc $class.Name).Functions) .Name).Desc}}{{with .Params}}

The following arguments are required:
{{end}}{{with $method := .}}{{range .Params}}{{if .Required}}
 * __{{.Name}}__: {{(index ((index ((index $data.Doc $class.Name).Functions) $method.Name).Params) .Name).Desc}}{{end}}{{end}}{{end}}

```ruby
response = {{call $data.Fnc.underscore $class.Name}}.{{call $data.Fnc.underscore .Name}}({{call $data.Fnc.prnt.ruby .Params ((index ((index $data.Doc $class.Name).Functions) .Name).Params) ", " true}}options)
```
{{end}}{{end}}{{end}}{{end}}
## Contributors
Here is a list of [Contributors](https://{{.Pkg.Git.Site}}/{{.Pkg.Git.User}}/{{.Pkg.Git.Name}}-ruby/contributors)

### TODO

## License
{{.Pkg.License}}

## Bug Reports
Report [here](https://{{.Pkg.Git.Site}}/{{.Pkg.Git.User}}/{{.Pkg.Git.Name}}-ruby/issues).

## Contact
{{.Pkg.Author.Name}} ({{.Pkg.Author.Email}})
